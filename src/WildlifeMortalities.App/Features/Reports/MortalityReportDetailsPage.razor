@attribute [Route(Constants.Routes.ReportDetailsPage)]
@using WildlifeMortalities.Data.Entities.Reports.SingleMortality
@using WildlifeMortalities.Data.Entities.Reports.MultipleMortalities
@using WildlifeMortalities.App.Features.Reports.Activities
@inherits DbContextAwareComponent


@if (_reportDetail is null)
{
    <MudAlert Severity="Severity.Error">Report not found.</MudAlert>
    return;
}
<PrintOrDownloadComponent ReportDetail="_reportDetail"/>

@if (HasIncompleteBioSubmissions())
{
    <MudChip Color="Color.Warning">Missing bio</MudChip>
}
@switch (_reportDetail.Report)
{
    case HumanWildlifeConflictMortalityReport report:
        <MudText Typo="Typo.h3" Class="mb-4">Human-wildlife conflict report</MudText>
        break;
    case IndividualHuntedMortalityReport report:
        <MudText Typo="Typo.h3" Class="mb-4">Individual hunt report</MudText>
        <IndividualHuntedMortalityReportDetailsComponent Report="@report"/>
        break;
    case OutfitterGuidedHuntReport report:
        <MudText Typo="Typo.h3" Class="mb-4">Outfitter guided hunt report</MudText>
        <OutfitterGuidedHuntReportDetailsComponent Report="@report"/>
        break;
    case SpecialGuidedHuntReport report:
        <MudText Typo="Typo.h3" Class="mb-4">Special guided hunt report</MudText>
        <SpecialGuidedHuntReportDetailsComponent Report="@report"/>
        break;
    case TrappedMortalitiesReport report:
        <MudText Typo="Typo.h3" Class="mb-4">Trapped report</MudText>
        <TrappedReportDetailsComponent Report="@report"/>
        break;
}

<MudField Label="Date submitted" DisableUnderLine="true">@_reportDetail.Report.DateSubmitted.ToString("D")</MudField>


@if (_reportDetail.Report is not IndividualHuntedMortalityReport)
{
    <MudText Typo="Typo.h5" Class="my-2">Mortalities</MudText>
}
<MudGrid>
    @foreach (var item in _reportDetail.Report.GetActivities())
    {
        <MudItem sm="3" xs="6">
            <ActivityCardComponent ActivityViewModel="@GetActivityVm(item)"/>
        </MudItem>
    }
</MudGrid>

<MudButton Variant="Variant.Filled" Color="Color.Secondary" Href="@Constants.Routes.GetEditReportPageLink(HumanReadablePersonId, ReportId)">Edit</MudButton>
