@page "/harvest-reports/create/{sealid:int}"
@using WildlifeMortalities.App.Data

<MudText Typo="Typo.h4" Class="mb-4">New Harvest Report</MudText>

<EditForm Model="HarvestReport" OnValidSubmit="Update">
    <MudItem xs="12" sm="6">
        <MudPaper Elevation="2" Class="pa-4">
            <MudField Label="Seal #">@SealId</MudField>
            <MudField Label="Species">Black Bear</MudField>
            <MudDatePicker Label="Kill Date" />
            <MudSelect Label="Subzone" T="string">
                <MudSelectItem Value='"519"'>519</MudSelectItem>
                <MudSelectItem Value='"598"'>598</MudSelectItem>
                <MudSelectItem Value='"614"'>614</MudSelectItem>
                <MudSelectItem Value='"701"'>701</MudSelectItem>
                <MudSelectItem Value='"714"'>714</MudSelectItem>
            </MudSelect>
            <MudSelect Label="Sex" T="string">
                <MudSelectItem Value='"Male"'>Male</MudSelectItem>
                <MudSelectItem Value='"Female"'>Female</MudSelectItem>
            </MudSelect>
            <MudItem xs="12" Class="d-flex justify-space-between py-2 px-3 mt-2">
                <MudButton ButtonType="ButtonType.Button" Variant="Variant.Filled" Color="Color.Secondary" Link="/harvest-reports">Cancel</MudButton>
                <MudButton ButtonType="ButtonType.Submit" Disabled="true" />
                <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto">Submit</MudButton>
            </MudItem>
        </MudPaper>
    </MudItem>

</EditForm>

@code {
    [Parameter]
    public int SealId { get; set; }

    [Inject]
    private NavigationManager Navigation { get; set; } = null!;

    [Inject]
    private ISnackbar Snackbar { get; set; } = null!;

    public HarvestReport HarvestReport { get; set; } = new();

    protected override Task OnInitializedAsync()
    {
        var rand = new Random();
        HarvestReport.Id = rand.Next(1, 400);
        return base.OnInitializedAsync();
    }

    private async Task Update()
    {
        Snackbar.Add($"Harvest Report {HarvestReport.Id} has been saved", Severity.Success, config => { config.VisibleStateDuration = 5000; });
        Navigation.NavigateTo($"/harvest-reports/details/{HarvestReport.Id}");
    }
}