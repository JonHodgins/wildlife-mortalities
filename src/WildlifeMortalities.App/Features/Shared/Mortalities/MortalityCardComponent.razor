@using WildlifeMortalities.App.Extensions;
@using WildlifeMortalities.Data.Entities.BiologicalSubmissions;
@using WildlifeMortalities.Data.Entities.Reports.SingleMortality;
<MudCard Elevation="5" Class="flex-column d-flex" Style="height: 100%">
    <MudCardHeader>
        <CardHeaderContent>
            <MudText Typo="Typo.h6">@MortalityViewModel.Species!.Value.GetDisplayName()</MudText>
        </CardHeaderContent>
         <CardHeaderActions>
            @if(MortalityViewModel.GetMortality() is IHasBioSubmission)
            {
                <MudIconButton Icon="@Icons.Material.Filled.Settings" Color="Color.Default" OnClick="(() => OpenBioSubmissionDialog())" />
            }
         </CardHeaderActions> 
    </MudCardHeader>
    <MudCardContent Class="flex-column d-flex" Style="height: 100%">
        <MudStack Row="false">
            @foreach (var property in MortalityViewModel.GetProperties())
            {
                var normalizedValue = (property.Value ?? string.Empty).ToLower();
                @if (bool.TryParse(property.Value, out var value))
                {
                    <MudCheckBox T="bool" ReadOnly="true" Checked="value" Label="@property.Key" />
                }
                else if (DateTime.TryParse(property.Value, out var dateValue))
                {
                    <MudField DisableUnderLine="true" Label="@property.Key">@dateValue.Date.ToShortDateString()</MudField>
                }
                else
                {
                    <MudField DisableUnderLine="true" Label="@property.Key">@property.Value</MudField>
                }
            }
            @if (MortalityViewModel.Landmark is not null && MortalityViewModel.Comment is not null)
            {
                <MudField DisableUnderLine="true" Label="Landmark">@MortalityViewModel.Landmark</MudField>
                <MudField DisableUnderLine="true" Label="Comment">@MortalityViewModel.Comment</MudField>
            }
        </MudStack>
        <MudSpacer />
    </MudCardContent>
    <MudCardActions>
        <MudStack Row="true" Class="justify-right">
            <MudSpacer />
            @*<MudIconButton Icon="@Icons.Material.Filled.Edit" OnClick="@(() => Edit(item))" Color="Color.Primary" />
            <MudIconButton Icon="@Icons.Material.Filled.Delete" OnClick="@(() => Delete(item))" Color="Color.Error" />*@
        </MudStack>
    </MudCardActions>
</MudCard>
@code {
    [Parameter]
    public MortalityViewModel MortalityViewModel { get; set; } = null!;

    private void OpenBioSubmissionDialog()
    {
        
    }
}
